"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createEnums = void 0;
const tslib_1 = require("tslib");
const Eta = tslib_1.__importStar(require("eta"));
const path = tslib_1.__importStar(require("path"));
const file_system_1 = require("./utils/file-system");
const field_1 = require("./utils/field");
const createEnums = async (apiBaseDir, entities, apiType) => {
    if (entities.length > 0) {
        const outputFile = path.join(apiBaseDir, "enums.ts");
        const allEnumsFields = entities
            .flatMap((entity) => (entity.fields || []).map((field) => {
            if (field.type === "enum") {
                return { ...field, name: (0, field_1.fieldToEnumType)(field.name, entity.name) };
            }
            return null;
        }))
            .filter(Boolean);
        if (allEnumsFields.length > 0) {
            Eta.configure({
                views: path.join(__dirname, "templates"),
            });
            const content = await Eta.renderFileAsync(`./${apiType}/enums-${apiType}`, {
                allEnumsFields,
            });
            (0, file_system_1.createFile)(outputFile, content);
        }
    }
};
exports.createEnums = createEnums;
