"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.runTemplateTests = exports.renderTemplate = exports.configureEta = void 0;
const tslib_1 = require("tslib");
const Eta = tslib_1.__importStar(require("eta"));
const path = tslib_1.__importStar(require("path"));
const globals_1 = require("@jest/globals");
/**
 * Configures Eta for template testing
 * @returns {void} Nothing
 */
function configureEta() {
    Eta.configure({
        views: path.join(__dirname, '../../../../lib/templates'),
    });
}
exports.configureEta = configureEta;
/**
 * Renders a template file with the given field data
 * @param templatePath The relative path to the template file
 * @param field The field data to render the template with
 * @returns {Promise<string|undefined>} The rendered template
 */
async function renderTemplate(templatePath, field) {
    return Eta.renderFileAsync(templatePath, { field });
}
exports.renderTemplate = renderTemplate;
/**
 * Run common test cases for a template
 *
 * @param templatePath Path to the template to test
 * @param testCases Array of test cases
 * @returns {void} Nothing
 */
function runTemplateTests(templatePath, testCases) {
    testCases.forEach(testCase => {
        (0, globals_1.it)(testCase.name, async () => {
            const rendered = await renderTemplate(templatePath, testCase.field);
            for (const assertion of testCase.assertions) {
                if (assertion.type === 'contains') {
                    (0, globals_1.expect)(rendered).toContain(assertion.text);
                }
                else {
                    (0, globals_1.expect)(rendered).not.toContain(assertion.text);
                }
            }
        });
    });
}
exports.runTemplateTests = runTemplateTests;
